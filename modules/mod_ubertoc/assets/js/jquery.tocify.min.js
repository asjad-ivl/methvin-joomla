(function(tocify){tocify(window.jQuery,window,document)})(function($,window,document,undefined){$.widget("toc.tocify",{version:"1.3.0",options:{context:"body",selectors:"h1, h2, h3",showAndHide:true,showEffect:"slideDown",showEffectSpeed:"medium",hideEffect:"slideUp",hideEffectSpeed:"medium",smoothScroll:true,smoothScrollSpeed:"medium",scrollTo:0,showAndHideOnScroll:true,highlightOnScroll:true,highlightOffset:40,theme:"twitterBootstrap",extendPage:true,extendPageOffset:true,history:true,addRule:true,
hashGenerator:"compact"},_create:function(){var self=this;self.items=[];self._generateToc();self._addCSSClasses();self.webkit=function(){for(var prop in window)if(prop)if(prop.toLowerCase().indexOf("webkit")!==-1)return true;return false}();self._setEventHandlers();$(window).load(function(){self._setActiveElement();self.element.bind("extend.tocify",function(){self._setActiveElement()})})},_generateToc:function(){var self=this,firstElem,li;if(this.options.selectors.indexOf(",")!==-1)firstElem=$(this.options.context).find(this.options.selectors.replace(/ /g,
"").substr(0,this.options.selectors.indexOf(","))+":not(.dont-index)");else firstElem=$(this.options.context).find(this.options.selectors.replace(/ /g,"")+":not(.dont-index)");firstElem.each(function(index){li=$("<li/>",{"id":"Header"+index,"class":"header"}).append(self._nestElements($(this),index));self.element.append(li);$(this).nextUntil(this.nodeName.toLowerCase()).each(function(){if($(this).find(self.options.selectors).length===0)$(this).filter(self.options.selectors).each(function(){self._appendSubheaders.call(this,
self,li)});else $(this).find(self.options.selectors).not(".dont-index").each(function(){self._appendSubheaders.call(this,self,li)})})});if(self.options.addRule)firstElem.not(":first").before($('<hr class="no-height"/>'));self.element.find("ul.sub-header a").wrap("<li/>")},_setActiveElement:function(){var self=this,hash=window.location.hash.substring(1),elem=self.element.find("a[data-unique='"+hash+"']");if(hash.length){self.element.find("."+self.focusClass).removeClass(self.focusClass);elem.addClass(self.focusClass);
if(self.options.showAndHide)elem.click()}else self.element.find("."+self.focusClass).removeClass(self.focusClass);return self},_nestElements:function(self,index){var arr,item,hashValue;arr=$.grep(this.items,function(item){return item===self.text()});if(arr.length)this.items.push(self.text()+index);else this.items.push(self.text());hashValue=this._generateHashValue(arr,self,index);item=$("<a/>",{"class":"item","href":"#"+hashValue,"data-unique":hashValue}).append($("<span/>",{"text":self.text()}));
self.before($("<div/>",{"name":hashValue,"data-unique":hashValue}));return item},_generateHashValue:function(arr,self,index){var hashValue="",hashGeneratorOption=this.options.hashGenerator;if(hashGeneratorOption==="pretty"){hashValue=self.text().toLowerCase().replace(/\s/g,"-");while(hashValue.indexOf("--")>-1)hashValue=hashValue.replace(/--/g,"-")}else if(typeof hashGeneratorOption==="function")hashValue=hashGeneratorOption(self.text(),self);else hashValue=self.text().replace(/\s/g,"");if(arr.length)hashValue+=
""+index;return hashValue},_appendSubheaders:function(self,li){var index=$(this).index(self.options.selectors),previousHeader=$(self.options.selectors).eq(index-1);if(+$(this).prop("tagName").charAt(1)<+previousHeader.prop("tagName").charAt(1))self.element.find(".sub-header").last().after(self._nestElements($(this),index).wrap("<li/>"));else if(+$(this).prop("tagName").charAt(1)===+previousHeader.prop("tagName").charAt(1))li.find(".item").last().after(self._nestElements($(this),index).wrap("<li/>"));
else li.find(".item").last().after($("<ul/>",{"class":"sub-header"})).next(".sub-header").append(self._nestElements($(this),index))},_setEventHandlers:function(){var self=this,$self,duration;this.element.on("click.tocify","a",function(event){if(self.options.history)window.location.hash=$(this).attr("data-unique");self.element.find("."+self.focusClass).removeClass(self.focusClass);$(this).addClass(self.focusClass);if(self.options.showAndHide){var elem=$('a[data-unique="'+$(this).attr("data-unique")+
'"]');self._triggerShow(elem)}self._scrollTo($(this))});this.element.find("a").on({"mouseenter.tocify":function(){$(this).addClass(self.hoverClass);$(this).css("cursor","pointer")},"mouseleave.tocify":function(){if(self.options.theme!=="twitterBootstrap")$(this).removeClass(self.hoverClass)}});$(window).on("scroll.tocify",function(){$("html, body").promise().done(function(){var winScrollTop=$(window).scrollTop(),winHeight=$(window).height(),docHeight=$(document).height(),scrollHeight=$("body")[0].scrollHeight,
elem,lastElemOffset;if(self.options.extendPage)if(self.webkit&&winScrollTop>=scrollHeight-winHeight-self.options.extendPageOffset||!self.webkit&&winHeight+winScrollTop>docHeight-self.options.extendPageOffset){self.element.scrollTop(winScrollTop);if(!$(".tocify-extend-page").length){lastElemOffset=$('div[data-unique="'+$(".item").last().attr("data-unique")+'"]').offset().top;$(self.options.context).append($("<div />",{"class":"tocify-extend-page","height":Math.abs(lastElemOffset-winScrollTop)+"px"}));
self.element.trigger("extend.tocify")}}setTimeout(function(){$(self.options.context).find("div[data-unique]").next().each(function(){if(Math.abs($(this).offset().top-winScrollTop)<self.options.highlightOffset){elem=$('a[data-unique="'+$(this).prev("div[data-unique]").attr("data-unique")+'"]');if(self.options.highlightOnScroll&&elem.length){self.element.find("."+self.focusClass).removeClass(self.focusClass);elem.addClass(self.focusClass)}if(self.options.showAndHideOnScroll&&self.options.showAndHide)self._triggerShow(elem,
true);return false}})},0)})});if("onhashchange"in window)window.onhashchange=function(){self._setActiveElement()}},show:function(elem,scroll){var self=this,element=elem;if(!elem.is(":visible")){if(!elem.find(".sub-header").length&&!elem.parent().is(".header")&&!elem.parent().is(":visible"))elem=elem.parents(".sub-header").add(elem);else if(!elem.children(".sub-header").length&&!elem.parent().is(".header"))elem=elem.closest(".sub-header");switch(self.options.showEffect){case "none":elem.show();break;
case "show":elem.show(self.options.showEffectSpeed);break;case "slideDown":elem.slideDown(self.options.showEffectSpeed);break;case "fadeIn":elem.fadeIn(self.options.showEffectSpeed);break;default:elem.show();break}}if(elem.parent().is(".header"))self.hide($(".sub-header").not(elem));else self.hide($(".sub-header").not(elem.closest(".header").find(".sub-header").not(elem.siblings())));return self},hide:function(elem){var self=this;switch(self.options.hideEffect){case "none":elem.hide();break;case "hide":elem.hide(self.options.hideEffectSpeed);
break;case "slideUp":elem.slideUp(self.options.hideEffectSpeed);break;case "fadeOut":elem.fadeOut(self.options.hideEffectSpeed);break;default:elem.hide();break}return self},_triggerShow:function(elem,scroll){var self=this;if(elem.parent().is(".header")||elem.next().is(".sub-header"))self.show(elem.next(".sub-header"),scroll);else if(elem.parent().is(".sub-header"))self.show(elem.parent(),scroll);return self},_addCSSClasses:function(){if(this.options.theme==="jqueryUI"){this.focusClass="ui-state-default";
this.hoverClass="ui-state-hover";this.element.addClass("ui-widget").find(".toc-title").addClass("ui-widget-header").end().find("a").addClass("ui-widget-content")}else if(this.options.theme==="twitterBootstrap"){this.element.addClass("nav nav-list");this.focusClass="active"}else{this.focusClass="tocify-focus";this.hoverClass="tocify-hover"}return this},setOption:function(){$.Widget.prototype._setOption.apply(this,arguments)},setOptions:function(){$.Widget.prototype._setOptions.apply(this,arguments)},
_scrollTo:function(elem,pageload){var self=this,duration=self.options.smoothScroll||0;$("html, body").promise().done(function(){$("html, body").animate({"scrollTop":$('div[data-unique="'+elem.attr("data-unique")+'"]').offset().top-self.options.scrollTo+"px"},{"duration":duration})});return self}})});


jQuery(document).ready(function($){
var $sidebar   = jQuery(".t3-sidebar-1 .t3-module.module"), 
              $window    = $(window),
              offset     = $sidebar.offset(),
              topPadding = $("#t3-mainnav").height()+24;

          $window.scroll(function() {

              if ($window.scrollTop() > offset.top && jQuery(window).width()>767) {
                  $sidebar.stop().animate({
                      marginTop: $window.scrollTop() - offset.top + topPadding
                  }, 'fast');
              } else {
                  $sidebar.css({
                      marginTop: 0
                  });
              }
          });
});